{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../../services/bookings/booking-manage.service\";\nimport * as i3 from \"../../../services/payments/payment-order.service\";\nimport * as i4 from \"../../../services/payments/payment-verify.service\";\nfunction PaymentComponent_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Loading booking details...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PaymentComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"h5\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\", 5);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\", 6);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function PaymentComponent_div_4_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.payNow());\n    });\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.booking.batchName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Instructor: \", ctx_r1.booking.instructorName, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Start Date: \", i0.ɵɵpipeBind1(7, 6, ctx_r1.booking.startDate), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" Amount: \\u20B9 \", ctx_r1.booking.amount, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.processing);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.processing ? \"Processing...\" : \"Pay Now\", \" \");\n  }\n}\nexport class PaymentComponent {\n  constructor(route, router, bookingApi, orderApi, verifyApi) {\n    this.route = route;\n    this.router = router;\n    this.bookingApi = bookingApi;\n    this.orderApi = orderApi;\n    this.verifyApi = verifyApi;\n    this.loading = true;\n    this.processing = false;\n  }\n  ngOnInit() {\n    this.bookingId = this.route.snapshot.paramMap.get('id');\n    this.loadBookingDetails();\n  }\n  loadBookingDetails() {\n    this.bookingApi.getBookingById(this.bookingId).subscribe({\n      next: res => {\n        this.booking = res;\n        this.loading = false;\n      },\n      error: err => {\n        console.error('Booking details error', err);\n        this.loading = false;\n      }\n    });\n  }\n  payNow() {\n    this.processing = true;\n    this.orderApi.createOrder({\n      bookingId: this.bookingId,\n      amount: this.booking.amount\n    }).subscribe({\n      next: order => this.openRazorpay(order),\n      error: err => {\n        console.error('Create order failed', err);\n        this.processing = false;\n      }\n    });\n  }\n  openRazorpay(order) {\n    const options = {\n      key: order.key,\n      amount: order.amount,\n      currency: order.currency,\n      name: 'Hairvona',\n      description: 'Batch Booking Payment',\n      order_id: order.orderId,\n      handler: response => {\n        this.verifyPayment(response);\n      }\n    };\n    const rzp = new Razorpay(options);\n    rzp.open();\n  }\n  verifyPayment(response) {\n    this.verifyApi.verifyPayment({\n      bookingId: this.bookingId,\n      razorpayOrderId: response.razorpay_order_id,\n      razorpayPaymentId: response.razorpay_payment_id,\n      razorpaySignature: response.razorpay_signature\n    }).subscribe({\n      next: () => {\n        this.processing = false;\n        this.router.navigate(['/user/bookings']);\n      },\n      error: err => {\n        console.error('Payment verification failed', err);\n        this.processing = false;\n        alert('Payment verification failed');\n      }\n    });\n  }\n  static {\n    this.ɵfac = function PaymentComponent_Factory(t) {\n      return new (t || PaymentComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.BookingManageService), i0.ɵɵdirectiveInject(i3.PaymentOrderService), i0.ɵɵdirectiveInject(i4.PaymentVerifyService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PaymentComponent,\n      selectors: [[\"app-payment\"]],\n      decls: 5,\n      vars: 2,\n      consts: [[1, \"page-container\"], [1, \"page-title\"], [4, \"ngIf\"], [\"class\", \"card p-3\", 4, \"ngIf\"], [1, \"card\", \"p-3\"], [1, \"text-muted\"], [1, \"fw-bold\", \"fs-5\"], [1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"]],\n      template: function PaymentComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n          i0.ɵɵtext(2, \"Payment\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(3, PaymentComponent_p_3_Template, 2, 0, \"p\", 2);\n          i0.ɵɵtemplate(4, PaymentComponent_div_4_Template, 12, 8, \"div\", 3);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.booking);\n        }\n      },\n      styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","PaymentComponent_div_4_Template_button_click_10_listener","ɵɵrestoreView","_r3","ctx_r2","ɵɵnextContext","ɵɵresetView","payNow","ɵɵadvance","ɵɵtextInterpolate","ctx_r1","booking","batchName","ɵɵtextInterpolate1","instructorName","ɵɵpipeBind1","startDate","amount","ɵɵproperty","processing","PaymentComponent","constructor","route","router","bookingApi","orderApi","verifyApi","loading","ngOnInit","bookingId","snapshot","paramMap","get","loadBookingDetails","getBookingById","subscribe","next","res","error","err","console","createOrder","order","openRazorpay","options","key","currency","name","description","order_id","orderId","handler","response","verifyPayment","rzp","Razorpay","open","razorpayOrderId","razorpay_order_id","razorpayPaymentId","razorpay_payment_id","razorpaySignature","razorpay_signature","navigate","alert","ɵɵdirectiveInject","i1","ActivatedRoute","Router","i2","BookingManageService","i3","PaymentOrderService","i4","PaymentVerifyService","selectors","decls","vars","consts","template","PaymentComponent_Template","rf","ctx","ɵɵtemplate","PaymentComponent_p_3_Template","PaymentComponent_div_4_Template"],"sources":["C:\\Users\\Sagar\\OneDrive\\Desktop\\Hairstylist Amar\\HairstylistAmar-Client-Angular\\HairStylistAmar\\src\\app\\modules\\user\\payment\\payment.component.ts","C:\\Users\\Sagar\\OneDrive\\Desktop\\Hairstylist Amar\\HairstylistAmar-Client-Angular\\HairStylistAmar\\src\\app\\modules\\user\\payment\\payment.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { BookingManageService } from '../../../services/bookings/booking-manage.service';\nimport { PaymentOrderService } from '../../../services/payments/payment-order.service';\nimport { PaymentVerifyService } from '../../../services/payments/payment-verify.service';\n\ndeclare var Razorpay: any;\n\n\n@Component({\n  selector: 'app-payment',\n  templateUrl: './payment.component.html',\n  styleUrls: ['./payment.component.css'],\n})\nexport class PaymentComponent implements OnInit {\n  bookingId!: string;\n  booking: any;\n  loading = true;\n  processing = false;\n\n  constructor(\n  private route: ActivatedRoute,\n  private router: Router,\n  private bookingApi: BookingManageService,\n  private orderApi: PaymentOrderService,\n  private verifyApi: PaymentVerifyService\n) {}\n\n\n  ngOnInit(): void {\n    this.bookingId = this.route.snapshot.paramMap.get('id')!;\n    this.loadBookingDetails();\n  }\n\n  loadBookingDetails() {\n    this.bookingApi.getBookingById(this.bookingId).subscribe({\n      next: (res) => {\n        this.booking = res;\n        this.loading = false;\n      },\n      error: (err) => {\n        console.error('Booking details error', err);\n        this.loading = false;\n      },\n    });\n  }\n\n  payNow() {\n    this.processing = true;\n\n    this.orderApi\n      .createOrder({\n        bookingId: this.bookingId,\n        amount: this.booking.amount,\n      })\n      .subscribe({\n        next: (order: any) => this.openRazorpay(order),\n        error: (err: any) => {\n          console.error('Create order failed', err);\n          this.processing = false;\n        },\n      });\n  }\n\n  openRazorpay(order: any) {\n    const options = {\n      key: order.key,\n      amount: order.amount,\n      currency: order.currency,\n      name: 'Hairvona',\n      description: 'Batch Booking Payment',\n      order_id: order.orderId,\n\n      handler: (response: any) => {\n        this.verifyPayment(response);\n      },\n    };\n\n    const rzp = new Razorpay(options);\n    rzp.open();\n  }\n\n  verifyPayment(response: any) {\n    this.verifyApi\n      .verifyPayment({\n        bookingId: this.bookingId,\n        razorpayOrderId: response.razorpay_order_id,\n        razorpayPaymentId: response.razorpay_payment_id,\n        razorpaySignature: response.razorpay_signature,\n      })\n      .subscribe({\n        next: () => {\n          this.processing = false;\n          this.router.navigate(['/user/bookings']);\n        },\n        error: (err: any) => {\n          console.error('Payment verification failed', err);\n          this.processing = false;\n          alert('Payment verification failed');\n        },\n      });\n  }\n}\n","<div class=\"page-container\">\n\n  <h2 class=\"page-title\">Payment</h2>\n\n  <!-- Loading -->\n  <p *ngIf=\"loading\">Loading booking details...</p>\n\n  <!-- Booking Summary -->\n  <div *ngIf=\"!loading && booking\" class=\"card p-3\">\n\n    <h5>{{ booking.batchName }}</h5>\n\n    <p class=\"text-muted\">\n      Instructor: {{ booking.instructorName }}\n    </p>\n\n    <p>\n      Start Date:\n      {{ booking.startDate | date }}\n    </p>\n\n    <p class=\"fw-bold fs-5\">\n      Amount: ₹ {{ booking.amount }}\n    </p>\n\n    <button\n      class=\"btn btn-primary\"\n      [disabled]=\"processing\"\n      (click)=\"payNow()\">\n      {{ processing ? 'Processing...' : 'Pay Now' }}\n    </button>\n\n  </div>\n\n</div>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}