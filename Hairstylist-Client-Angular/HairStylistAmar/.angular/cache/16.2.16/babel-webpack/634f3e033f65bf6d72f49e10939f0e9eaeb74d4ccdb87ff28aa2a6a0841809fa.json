{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { API } from 'src/app/core/api/api-constants.service';\nexport let BookBatchComponent = class BookBatchComponent {\n  constructor(http, router, bookingApi) {\n    this.http = http;\n    this.router = router;\n    this.bookingApi = bookingApi;\n    this.services = [];\n    this.batches = [];\n    this.selectedService = null;\n    this.loading = true;\n    this.activeBatchId = null;\n    this.studentMobile = '';\n    this.processing = false;\n    this.FILE_BASE = 'https://localhost:7154';\n  }\n  ngOnInit() {\n    this.loadServices();\n  }\n  // ðŸ”¹ Load services\n  loadServices() {\n    this.http.get(API.services).subscribe({\n      next: res => {\n        this.services = res;\n        this.loading = false;\n      },\n      error: () => this.loading = false\n    });\n  }\n  // ðŸ”¹ Select service\n  selectService(service) {\n    if (this.selectedService?.serviceId === service.serviceId) {\n      this.selectedService = null;\n      this.batches = [];\n      return;\n    }\n    this.selectedService = service;\n    this.activeBatchId = null;\n    this.studentMobile = '';\n    this.loadBatches(service.serviceId);\n  }\n  // ðŸ”¹ Load batches\n  loadBatches(serviceId) {\n    this.http.get(`${API.batches}/service/${serviceId}`).subscribe(res => {\n      this.batches = res;\n      if (res.length > 0) {\n        this.selectedService.instructor = res[0].instructor;\n      }\n    });\n  }\n  // ðŸ”¹ Open mobile input\n  openMobileInput(batchId) {\n    this.activeBatchId = batchId;\n    this.studentMobile = ''; // âœ… reset every time\n  }\n  // ðŸ”¹ Confirm booking\n  confirmBooking(batchId) {\n    const mobile = this.studentMobile?.trim();\n    if (this.processing || !mobile || mobile.length !== 10) {\n      alert('Please enter a valid 10-digit mobile number');\n      return;\n    }\n    const userId = localStorage.getItem('userId');\n    if (!userId) {\n      alert('Please login again');\n      return;\n    }\n    this.processing = true;\n    this.bookingApi.createBooking({\n      userId,\n      batchId,\n      studentMobile: mobile\n    }).subscribe({\n      next: res => {\n        this.processing = false;\n        this.router.navigate(['/user/payment', res.bookingId]);\n      },\n      error: err => {\n        console.error('Booking failed', err);\n        this.processing = false;\n        alert(err?.error || 'Booking failed');\n      }\n    });\n  }\n  // ðŸ”¹ Instructor photo\n  getInstructorPhoto(instructor) {\n    if (!instructor || !instructor.photoUrl) {\n      return 'assets/user.png';\n    }\n    if (instructor.photoUrl.startsWith('http')) {\n      return instructor.photoUrl;\n    }\n    return `${this.FILE_BASE}${instructor.photoUrl}`;\n  }\n};\nBookBatchComponent = __decorate([Component({\n  selector: 'app-book-batch',\n  templateUrl: './book-batch.component.html',\n  styleUrls: ['./book-batch.component.css']\n})], BookBatchComponent);","map":{"version":3,"names":["Component","API","BookBatchComponent","constructor","http","router","bookingApi","services","batches","selectedService","loading","activeBatchId","studentMobile","processing","FILE_BASE","ngOnInit","loadServices","get","subscribe","next","res","error","selectService","service","serviceId","loadBatches","length","instructor","openMobileInput","batchId","confirmBooking","mobile","trim","alert","userId","localStorage","getItem","createBooking","navigate","bookingId","err","console","getInstructorPhoto","photoUrl","startsWith","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\Sagar\\OneDrive\\Desktop\\Hairstylist Amar\\HairstylistAmar-Client-Angular\\HairStylistAmar\\src\\app\\modules\\user\\book-batch\\book-batch.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { API } from 'src/app/core/api/api-constants.service';\nimport { BookingUserService } from 'src/app/services/bookings/booking-user.service';\n\n@Component({\n  selector: 'app-book-batch',\n  templateUrl: './book-batch.component.html',\n  styleUrls: ['./book-batch.component.css'],\n})\nexport class BookBatchComponent implements OnInit {\n\n  services: any[] = [];\n  batches: any[] = [];\n  selectedService: any = null;\n\n  loading = true;\n  activeBatchId: string | null = null;\n  studentMobile = '';\n  processing = false;\n\n  FILE_BASE = 'https://localhost:7154';\n\n  constructor(\n    private http: HttpClient,\n    private router: Router,\n    private bookingApi: BookingUserService\n  ) {}\n\n  ngOnInit(): void {\n    this.loadServices();\n  }\n\n  // ðŸ”¹ Load services\n  loadServices(): void {\n    this.http.get<any[]>(API.services).subscribe({\n      next: res => {\n        this.services = res;\n        this.loading = false;\n      },\n      error: () => this.loading = false\n    });\n  }\n\n  // ðŸ”¹ Select service\n  selectService(service: any): void {\n    if (this.selectedService?.serviceId === service.serviceId) {\n      this.selectedService = null;\n      this.batches = [];\n      return;\n    }\n\n    this.selectedService = service;\n    this.activeBatchId = null;\n    this.studentMobile = '';\n\n    this.loadBatches(service.serviceId);\n  }\n\n  // ðŸ”¹ Load batches\n  loadBatches(serviceId: string): void {\n    this.http\n      .get<any[]>(`${API.batches}/service/${serviceId}`)\n      .subscribe(res => {\n        this.batches = res;\n\n        if (res.length > 0) {\n          this.selectedService.instructor = res[0].instructor;\n        }\n      });\n  }\n\n  // ðŸ”¹ Open mobile input\n  openMobileInput(batchId: string): void {\n    this.activeBatchId = batchId;\n    this.studentMobile = '';   // âœ… reset every time\n  }\n\n  // ðŸ”¹ Confirm booking\n  confirmBooking(batchId: string): void {\n\n    const mobile = this.studentMobile?.trim();\n\n    if (this.processing || !mobile || mobile.length !== 10) {\n      alert('Please enter a valid 10-digit mobile number');\n      return;\n    }\n\n    const userId = localStorage.getItem('userId');\n    if (!userId) {\n      alert('Please login again');\n      return;\n    }\n\n    this.processing = true;\n\n    this.bookingApi.createBooking({\n      userId,\n      batchId,\n      studentMobile: mobile\n    }).subscribe({\n      next: (res: any) => {\n        this.processing = false;\n        this.router.navigate(['/user/payment', res.bookingId]);\n      },\n      error: (err) => {\n        console.error('Booking failed', err);\n        this.processing = false;\n        alert(err?.error || 'Booking failed');\n      }\n    });\n  }\n\n  // ðŸ”¹ Instructor photo\n  getInstructorPhoto(instructor: any): string {\n    if (!instructor || !instructor.photoUrl) {\n      return 'assets/user.png';\n    }\n\n    if (instructor.photoUrl.startsWith('http')) {\n      return instructor.photoUrl;\n    }\n\n    return `${this.FILE_BASE}${instructor.photoUrl}`;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}