{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nexport let PaymentComponent = class PaymentComponent {\n  constructor(route, router, bookingApi, orderApi, verifyApi) {\n    this.route = route;\n    this.router = router;\n    this.bookingApi = bookingApi;\n    this.orderApi = orderApi;\n    this.verifyApi = verifyApi;\n    this.loading = true;\n    this.processing = false;\n  }\n  ngOnInit() {\n    this.bookingId = this.route.snapshot.paramMap.get('id');\n    this.loadBookingDetails();\n  }\n  loadBookingDetails() {\n    this.bookingApi.getBookingById(this.bookingId).subscribe({\n      next: res => {\n        this.booking = res;\n        this.loading = false;\n      },\n      error: err => {\n        console.error('Booking details error', err);\n        this.loading = false;\n      }\n    });\n  }\n  payNow() {\n    this.processing = true;\n    this.orderApi.createOrder({\n      bookingId: this.bookingId,\n      amount: this.booking.amount\n    }).subscribe({\n      next: order => this.openRazorpay(order),\n      error: err => {\n        console.error('Create order failed', err);\n        this.processing = false;\n      }\n    });\n  }\n  openRazorpay(order) {\n    const options = {\n      key: order.key,\n      amount: order.amount,\n      currency: order.currency,\n      name: 'Hairvona',\n      description: 'Batch Booking Payment',\n      order_id: order.orderId,\n      handler: response => {\n        this.verifyPayment(response);\n      }\n    };\n    const rzp = new Razorpay(options);\n    rzp.open();\n  }\n  verifyPayment(response) {\n    this.verifyApi.verifyPayment({\n      bookingId: this.bookingId,\n      razorpayOrderId: response.razorpay_order_id,\n      razorpayPaymentId: response.razorpay_payment_id,\n      razorpaySignature: response.razorpay_signature\n    }).subscribe({\n      next: () => {\n        this.processing = false;\n        this.router.navigate(['/user/bookings']);\n      },\n      error: err => {\n        console.error('Payment verification failed', err);\n        this.processing = false;\n        alert('Payment verification failed');\n      }\n    });\n  }\n};\nPaymentComponent = __decorate([Component({\n  selector: 'app-payment',\n  templateUrl: './payment.component.html',\n  styleUrls: ['./payment.component.css']\n})], PaymentComponent);","map":{"version":3,"names":["Component","PaymentComponent","constructor","route","router","bookingApi","orderApi","verifyApi","loading","processing","ngOnInit","bookingId","snapshot","paramMap","get","loadBookingDetails","getBookingById","subscribe","next","res","booking","error","err","console","payNow","createOrder","amount","order","openRazorpay","options","key","currency","name","description","order_id","orderId","handler","response","verifyPayment","rzp","Razorpay","open","razorpayOrderId","razorpay_order_id","razorpayPaymentId","razorpay_payment_id","razorpaySignature","razorpay_signature","navigate","alert","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\Sagar\\OneDrive\\Desktop\\Hairstylist Amar\\HairstylistAmar-Client-Angular\\HairStylistAmar\\src\\app\\modules\\user\\payment\\payment.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { BookingManageService } from '../../../services/bookings/booking-manage.service';\nimport { PaymentOrderService } from '../../../services/payments/payment-order.service';\nimport { PaymentVerifyService } from '../../../services/payments/payment-verify.service';\n\ndeclare var Razorpay: any;\n\n\n@Component({\n  selector: 'app-payment',\n  templateUrl: './payment.component.html',\n  styleUrls: ['./payment.component.css'],\n})\nexport class PaymentComponent implements OnInit {\n  bookingId!: string;\n  booking: any;\n  loading = true;\n  processing = false;\n\n  constructor(\n  private route: ActivatedRoute,\n  private router: Router,\n  private bookingApi: BookingManageService,\n  private orderApi: PaymentOrderService,\n  private verifyApi: PaymentVerifyService\n) {}\n\n\n  ngOnInit(): void {\n    this.bookingId = this.route.snapshot.paramMap.get('id')!;\n    this.loadBookingDetails();\n  }\n\n  loadBookingDetails() {\n    this.bookingApi.getBookingById(this.bookingId).subscribe({\n      next: (res) => {\n        this.booking = res;\n        this.loading = false;\n      },\n      error: (err) => {\n        console.error('Booking details error', err);\n        this.loading = false;\n      },\n    });\n  }\n\n  payNow() {\n    this.processing = true;\n\n    this.orderApi\n      .createOrder({\n        bookingId: this.bookingId,\n        amount: this.booking.amount,\n      })\n      .subscribe({\n        next: (order: any) => this.openRazorpay(order),\n        error: (err: any) => {\n          console.error('Create order failed', err);\n          this.processing = false;\n        },\n      });\n  }\n\n  openRazorpay(order: any) {\n    const options = {\n      key: order.key,\n      amount: order.amount,\n      currency: order.currency,\n      name: 'Hairvona',\n      description: 'Batch Booking Payment',\n      order_id: order.orderId,\n\n      handler: (response: any) => {\n        this.verifyPayment(response);\n      },\n    };\n\n    const rzp = new Razorpay(options);\n    rzp.open();\n  }\n\n  verifyPayment(response: any) {\n    this.verifyApi\n      .verifyPayment({\n        bookingId: this.bookingId,\n        razorpayOrderId: response.razorpay_order_id,\n        razorpayPaymentId: response.razorpay_payment_id,\n        razorpaySignature: response.razorpay_signature,\n      })\n      .subscribe({\n        next: () => {\n          this.processing = false;\n          this.router.navigate(['/user/bookings']);\n        },\n        error: (err: any) => {\n          console.error('Payment verification failed', err);\n          this.processing = false;\n          alert('Payment verification failed');\n        },\n      });\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}