{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../../services/bookings/booking-manage.service\";\nimport * as i3 from \"../../../services/payments/payment-order.service\";\nimport * as i4 from \"../../../services/payments/payment-verify.service\";\nimport * as i5 from \"@angular/common\";\nfunction PaymentComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"div\", 2)(1, \"h2\", 3);\n    i0.ÉµÉµtext(2, \"\\uD83D\\uDCB3 Complete Payment\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(3, \"div\", 4)(4, \"div\", 5)(5, \"h3\");\n    i0.ÉµÉµtext(6);\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(7, \"span\", 6);\n    i0.ÉµÉµtext(8);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(9, \"div\", 7)(10, \"div\", 8)(11, \"span\");\n    i0.ÉµÉµtext(12, \"Instructor\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(13, \"strong\");\n    i0.ÉµÉµtext(14);\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(15, \"div\", 8)(16, \"span\");\n    i0.ÉµÉµtext(17, \"Start Date\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(18, \"strong\");\n    i0.ÉµÉµtext(19);\n    i0.ÉµÉµpipe(20, \"date\");\n    i0.ÉµÉµelementEnd()();\n    i0.ÉµÉµelementStart(21, \"div\", 9)(22, \"span\");\n    i0.ÉµÉµtext(23, \"Total Amount\");\n    i0.ÉµÉµelementEnd();\n    i0.ÉµÉµelementStart(24, \"strong\");\n    i0.ÉµÉµtext(25);\n    i0.ÉµÉµelementEnd()()()();\n    i0.ÉµÉµelementStart(26, \"button\", 10);\n    i0.ÉµÉµtext(27);\n    i0.ÉµÉµelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance(6);\n    i0.ÉµÉµtextInterpolate(ctx_r0.booking.batchName);\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate(ctx_r0.booking.status);\n    i0.ÉµÉµadvance(6);\n    i0.ÉµÉµtextInterpolate(ctx_r0.booking.instructorName);\n    i0.ÉµÉµadvance(5);\n    i0.ÉµÉµtextInterpolate(i0.ÉµÉµpipeBind1(20, 6, ctx_r0.booking.startDate));\n    i0.ÉµÉµadvance(6);\n    i0.ÉµÉµtextInterpolate1(\"\\u20B9\", ctx_r0.booking.amount, \"\");\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµtextInterpolate1(\" Pay \\u20B9\", ctx_r0.booking.amount, \" \");\n  }\n}\nfunction PaymentComponent_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ÉµÉµelementStart(0, \"p\", 11);\n    i0.ÉµÉµtext(1, \" Loading payment details...\\n\");\n    i0.ÉµÉµelementEnd();\n  }\n}\nexport class PaymentComponent {\n  constructor(route, router, bookingApi, orderApi, verifyApi) {\n    this.route = route;\n    this.router = router;\n    this.bookingApi = bookingApi;\n    this.orderApi = orderApi;\n    this.verifyApi = verifyApi;\n    this.loading = true;\n    this.processing = false;\n  }\n  ngOnInit() {\n    this.bookingId = this.route.snapshot.paramMap.get('id');\n    this.loadBookingDetails();\n  }\n  loadBookingDetails() {\n    this.bookingApi.getBookingById(this.bookingId).subscribe({\n      next: res => {\n        this.booking = res;\n        this.loading = false;\n      },\n      error: err => {\n        console.error('Booking details error', err);\n        this.loading = false;\n      }\n    });\n  }\n  payNow() {\n    this.processing = true;\n    this.orderApi.createOrder({\n      bookingId: this.bookingId,\n      amount: this.booking.amount\n    }).subscribe({\n      next: order => this.openRazorpay(order),\n      error: err => {\n        console.error('Create order failed', err);\n        this.processing = false;\n      }\n    });\n  }\n  openRazorpay(order) {\n    const options = {\n      key: order.key,\n      amount: order.amount,\n      currency: order.currency,\n      name: 'Hairvona',\n      description: 'Batch Booking Payment',\n      order_id: order.orderId,\n      handler: response => {\n        this.verifyPayment(response);\n      }\n    };\n    const rzp = new Razorpay(options);\n    rzp.open();\n  }\n  verifyPayment(response) {\n    this.verifyApi.verifyPayment({\n      bookingId: this.bookingId,\n      razorpayOrderId: response.razorpay_order_id,\n      razorpayPaymentId: response.razorpay_payment_id,\n      razorpaySignature: response.razorpay_signature\n    }).subscribe({\n      next: () => {\n        this.processing = false;\n        this.router.navigate(['/user/bookings']);\n      },\n      error: err => {\n        console.error('Payment verification failed', err);\n        this.processing = false;\n        alert('Payment verification failed');\n      }\n    });\n  }\n  static {\n    this.Éµfac = function PaymentComponent_Factory(t) {\n      return new (t || PaymentComponent)(i0.ÉµÉµdirectiveInject(i1.ActivatedRoute), i0.ÉµÉµdirectiveInject(i1.Router), i0.ÉµÉµdirectiveInject(i2.BookingManageService), i0.ÉµÉµdirectiveInject(i3.PaymentOrderService), i0.ÉµÉµdirectiveInject(i4.PaymentVerifyService));\n    };\n  }\n  static {\n    this.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n      type: PaymentComponent,\n      selectors: [[\"app-payment\"]],\n      decls: 2,\n      vars: 2,\n      consts: [[\"class\", \"payment-page\", 4, \"ngIf\"], [\"class\", \"loading-text\", 4, \"ngIf\"], [1, \"payment-page\"], [1, \"page-title\"], [1, \"payment-card\"], [1, \"card-header\"], [1, \"status\", \"pending\"], [1, \"card-body\"], [1, \"info-row\"], [1, \"info-row\", \"total\"], [1, \"pay-btn\"], [1, \"loading-text\"]],\n      template: function PaymentComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ÉµÉµtemplate(0, PaymentComponent_div_0_Template, 28, 8, \"div\", 0);\n          i0.ÉµÉµtemplate(1, PaymentComponent_p_1_Template, 2, 0, \"p\", 1);\n        }\n        if (rf & 2) {\n          i0.ÉµÉµproperty(\"ngIf\", ctx.booking);\n          i0.ÉµÉµadvance(1);\n          i0.ÉµÉµproperty(\"ngIf\", !ctx.booking);\n        }\n      },\n      dependencies: [i5.NgIf, i5.DatePipe],\n      styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["i0","ÉµÉµelementStart","ÉµÉµtext","ÉµÉµelementEnd","ÉµÉµadvance","ÉµÉµtextInterpolate","ctx_r0","booking","batchName","status","instructorName","ÉµÉµpipeBind1","startDate","ÉµÉµtextInterpolate1","amount","PaymentComponent","constructor","route","router","bookingApi","orderApi","verifyApi","loading","processing","ngOnInit","bookingId","snapshot","paramMap","get","loadBookingDetails","getBookingById","subscribe","next","res","error","err","console","payNow","createOrder","order","openRazorpay","options","key","currency","name","description","order_id","orderId","handler","response","verifyPayment","rzp","Razorpay","open","razorpayOrderId","razorpay_order_id","razorpayPaymentId","razorpay_payment_id","razorpaySignature","razorpay_signature","navigate","alert","ÉµÉµdirectiveInject","i1","ActivatedRoute","Router","i2","BookingManageService","i3","PaymentOrderService","i4","PaymentVerifyService","selectors","decls","vars","consts","template","PaymentComponent_Template","rf","ctx","ÉµÉµtemplate","PaymentComponent_div_0_Template","PaymentComponent_p_1_Template","ÉµÉµproperty"],"sources":["C:\\Users\\Sagar\\OneDrive\\Desktop\\Hairstylist Amar\\HairstylistAmar-Client-Angular\\HairStylistAmar\\src\\app\\modules\\user\\payment\\payment.component.ts","C:\\Users\\Sagar\\OneDrive\\Desktop\\Hairstylist Amar\\HairstylistAmar-Client-Angular\\HairStylistAmar\\src\\app\\modules\\user\\payment\\payment.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { BookingManageService } from '../../../services/bookings/booking-manage.service';\nimport { PaymentOrderService } from '../../../services/payments/payment-order.service';\nimport { PaymentVerifyService } from '../../../services/payments/payment-verify.service';\n\ndeclare var Razorpay: any;\n\n\n@Component({\n  selector: 'app-payment',\n  templateUrl: './payment.component.html',\n  styleUrls: ['./payment.component.css'],\n})\nexport class PaymentComponent implements OnInit {\n  bookingId!: string;\n  booking: any;\n  loading = true;\n  processing = false;\n\n  constructor(\n  private route: ActivatedRoute,\n  private router: Router,\n  private bookingApi: BookingManageService,\n  private orderApi: PaymentOrderService,\n  private verifyApi: PaymentVerifyService\n) {}\n\n\n  ngOnInit(): void {\n    this.bookingId = this.route.snapshot.paramMap.get('id')!;\n    this.loadBookingDetails();\n  }\n\n  loadBookingDetails() {\n    this.bookingApi.getBookingById(this.bookingId).subscribe({\n      next: (res) => {\n        this.booking = res;\n        this.loading = false;\n      },\n      error: (err) => {\n        console.error('Booking details error', err);\n        this.loading = false;\n      },\n    });\n  }\n\n  payNow() {\n    this.processing = true;\n\n    this.orderApi\n      .createOrder({\n        bookingId: this.bookingId,\n        amount: this.booking.amount,\n      })\n      .subscribe({\n        next: (order: any) => this.openRazorpay(order),\n        error: (err: any) => {\n          console.error('Create order failed', err);\n          this.processing = false;\n        },\n      });\n  }\n\n  openRazorpay(order: any) {\n    const options = {\n      key: order.key,\n      amount: order.amount,\n      currency: order.currency,\n      name: 'Hairvona',\n      description: 'Batch Booking Payment',\n      order_id: order.orderId,\n\n      handler: (response: any) => {\n        this.verifyPayment(response);\n      },\n    };\n\n    const rzp = new Razorpay(options);\n    rzp.open();\n  }\n\n  verifyPayment(response: any) {\n    this.verifyApi\n      .verifyPayment({\n        bookingId: this.bookingId,\n        razorpayOrderId: response.razorpay_order_id,\n        razorpayPaymentId: response.razorpay_payment_id,\n        razorpaySignature: response.razorpay_signature,\n      })\n      .subscribe({\n        next: () => {\n          this.processing = false;\n          this.router.navigate(['/user/bookings']);\n        },\n        error: (err: any) => {\n          console.error('Payment verification failed', err);\n          this.processing = false;\n          alert('Payment verification failed');\n        },\n      });\n  }\n}\n","<div class=\"payment-page\" *ngIf=\"booking\">\n\n  <h2 class=\"page-title\">ðŸ’³ Complete Payment</h2>\n\n  <!-- Booking Summary -->\n  <div class=\"payment-card\">\n\n    <div class=\"card-header\">\n      <h3>{{ booking.batchName }}</h3>\n      <span class=\"status pending\">{{ booking.status }}</span>\n    </div>\n\n    <div class=\"card-body\">\n      <div class=\"info-row\">\n        <span>Instructor</span>\n        <strong>{{ booking.instructorName }}</strong>\n      </div>\n\n      <div class=\"info-row\">\n        <span>Start Date</span>\n        <strong>{{ booking.startDate | date }}</strong>\n      </div>\n\n      <div class=\"info-row total\">\n        <span>Total Amount</span>\n        <strong>â‚¹{{ booking.amount }}</strong>\n      </div>\n    </div>\n\n  </div>\n\n  <!-- Pay Button -->\n  <button class=\"pay-btn\">\n    Pay â‚¹{{ booking.amount }}\n  </button>\n\n</div>\n\n<!-- Loading -->\n<p *ngIf=\"!booking\" class=\"loading-text\">\n  Loading payment details...\n</p>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}