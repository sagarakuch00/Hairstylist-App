{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nexport class AuthService {\n  constructor(http, router, zone) {\n    this.http = http;\n    this.router = router;\n    this.zone = zone;\n    this.googleClientId = '682018676352-6e452dp8cectm769t5t5roh3065h0n0h.apps.googleusercontent.com';\n    this.apiBase = 'https://localhost:7154/api/auth';\n  }\n  initGoogleLogin() {\n    // @ts-ignore\n    google.accounts.id.initialize({\n      client_id: this.googleClientId,\n      callback: response => this.handleGoogleCredential(response)\n    });\n    // @ts-ignore\n    google.accounts.id.renderButton(document.getElementById('googleBtn'), {\n      theme: 'outline',\n      size: 'large',\n      width: 260\n    });\n  }\n  handleGoogleCredential(response) {\n    const idToken = response.credential;\n    this.http.post(`${this.apiBase}/google-login`, {\n      idToken\n    }).subscribe({\n      next: res => {\n        // Keep backend userId, token but ignore role for now\n        localStorage.setItem('token', res.token);\n        localStorage.setItem('userId', res.userId);\n        // ALWAYS move to role selection page\n        this.zone.run(() => {\n          this.router.navigate(['/select-role']);\n        });\n      },\n      error: err => {\n        console.error('Google login failed:', err);\n        alert('Google login failed. Try again.');\n      }\n    });\n  }\n  setRole(role) {\n    localStorage.setItem('role', role);\n    if (role === 'Instructor') {\n      this.router.navigate(['/instructor/dashboard']);\n    } else {\n      this.router.navigate(['/user/dashboard']);\n    }\n  }\n  logout() {\n    localStorage.clear();\n    this.router.navigate(['/login']);\n  }\n  static {\n    this.ɵfac = function AuthService_Factory(t) {\n      return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i0.NgZone));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["AuthService","constructor","http","router","zone","googleClientId","apiBase","initGoogleLogin","google","accounts","id","initialize","client_id","callback","response","handleGoogleCredential","renderButton","document","getElementById","theme","size","width","idToken","credential","post","subscribe","next","res","localStorage","setItem","token","userId","run","navigate","error","err","console","alert","setRole","role","logout","clear","i0","ɵɵinject","i1","HttpClient","i2","Router","NgZone","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Sagar\\OneDrive\\Desktop\\Hairstylist Amar\\HairstylistAmar-Client-Angular\\HairStylistAmar\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { Injectable, NgZone } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Router } from '@angular/router';\n\n@Injectable({ providedIn: 'root' })\nexport class AuthService {\n\n  private googleClientId =\n    '682018676352-6e452dp8cectm769t5t5roh3065h0n0h.apps.googleusercontent.com';\n\n  private apiBase = 'https://localhost:7154/api/auth';\n\n  constructor(\n    private http: HttpClient,\n    private router: Router,\n    private zone: NgZone\n  ) {}\n\n  initGoogleLogin() {\n    // @ts-ignore\n    google.accounts.id.initialize({\n      client_id: this.googleClientId,\n      callback: (response: any) => this.handleGoogleCredential(response)\n    });\n\n    // @ts-ignore\n    google.accounts.id.renderButton(\n      document.getElementById('googleBtn'),\n      { theme: 'outline', size: 'large', width: 260 }\n    );\n  }\n\n  private handleGoogleCredential(response: any) {\n    const idToken = response.credential;\n\n    this.http.post(`${this.apiBase}/google-login`, { idToken })\n      .subscribe({\n        next: (res: any) => {\n\n          // Keep backend userId, token but ignore role for now\n          localStorage.setItem('token', res.token);\n          localStorage.setItem('userId', res.userId);\n\n          // ALWAYS move to role selection page\n          this.zone.run(() => {\n            this.router.navigate(['/select-role']);\n          });\n        },\n        error: err => {\n          console.error('Google login failed:', err);\n          alert('Google login failed. Try again.');\n        }\n      });\n  }\n\n  setRole(role: string) {\n    localStorage.setItem('role', role);\n\n    if (role === 'Instructor') {\n      this.router.navigate(['/instructor/dashboard']);\n    } else {\n      this.router.navigate(['/user/dashboard']);\n    }\n  }\n\n  logout() {\n    localStorage.clear();\n    this.router.navigate(['/login']);\n  }\n}\n"],"mappings":";;;AAKA,OAAM,MAAOA,WAAW;EAOtBC,YACUC,IAAgB,EAChBC,MAAc,EACdC,IAAY;IAFZ,KAAAF,IAAI,GAAJA,IAAI;IACJ,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,IAAI,GAAJA,IAAI;IARN,KAAAC,cAAc,GACpB,0EAA0E;IAEpE,KAAAC,OAAO,GAAG,iCAAiC;EAMhD;EAEHC,eAAeA,CAAA;IACb;IACAC,MAAM,CAACC,QAAQ,CAACC,EAAE,CAACC,UAAU,CAAC;MAC5BC,SAAS,EAAE,IAAI,CAACP,cAAc;MAC9BQ,QAAQ,EAAGC,QAAa,IAAK,IAAI,CAACC,sBAAsB,CAACD,QAAQ;KAClE,CAAC;IAEF;IACAN,MAAM,CAACC,QAAQ,CAACC,EAAE,CAACM,YAAY,CAC7BC,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAC,EACpC;MAAEC,KAAK,EAAE,SAAS;MAAEC,IAAI,EAAE,OAAO;MAAEC,KAAK,EAAE;IAAG,CAAE,CAChD;EACH;EAEQN,sBAAsBA,CAACD,QAAa;IAC1C,MAAMQ,OAAO,GAAGR,QAAQ,CAACS,UAAU;IAEnC,IAAI,CAACrB,IAAI,CAACsB,IAAI,CAAC,GAAG,IAAI,CAAClB,OAAO,eAAe,EAAE;MAAEgB;IAAO,CAAE,CAAC,CACxDG,SAAS,CAAC;MACTC,IAAI,EAAGC,GAAQ,IAAI;QAEjB;QACAC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,GAAG,CAACG,KAAK,CAAC;QACxCF,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEF,GAAG,CAACI,MAAM,CAAC;QAE1C;QACA,IAAI,CAAC3B,IAAI,CAAC4B,GAAG,CAAC,MAAK;UACjB,IAAI,CAAC7B,MAAM,CAAC8B,QAAQ,CAAC,CAAC,cAAc,CAAC,CAAC;QACxC,CAAC,CAAC;MACJ,CAAC;MACDC,KAAK,EAAEC,GAAG,IAAG;QACXC,OAAO,CAACF,KAAK,CAAC,sBAAsB,EAAEC,GAAG,CAAC;QAC1CE,KAAK,CAAC,iCAAiC,CAAC;MAC1C;KACD,CAAC;EACN;EAEAC,OAAOA,CAACC,IAAY;IAClBX,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEU,IAAI,CAAC;IAElC,IAAIA,IAAI,KAAK,YAAY,EAAE;MACzB,IAAI,CAACpC,MAAM,CAAC8B,QAAQ,CAAC,CAAC,uBAAuB,CAAC,CAAC;KAChD,MAAM;MACL,IAAI,CAAC9B,MAAM,CAAC8B,QAAQ,CAAC,CAAC,iBAAiB,CAAC,CAAC;;EAE7C;EAEAO,MAAMA,CAAA;IACJZ,YAAY,CAACa,KAAK,EAAE;IACpB,IAAI,CAACtC,MAAM,CAAC8B,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;EAClC;;;uBA/DWjC,WAAW,EAAA0C,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,MAAA,GAAAL,EAAA,CAAAC,QAAA,CAAAD,EAAA,CAAAM,MAAA;IAAA;EAAA;;;aAAXhD,WAAW;MAAAiD,OAAA,EAAXjD,WAAW,CAAAkD,IAAA;MAAAC,UAAA,EADE;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}